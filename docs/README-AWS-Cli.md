# DevOpsCorner AWS-Cli v2

DevOps Corner Indonesia - AWS Cli v2 Container Image (`Alpine 3.17` & `Python 3.10.10`)

![all contributors](https://img.shields.io/github/contributors/devopscorner/devopscorner-container)
![tags](https://img.shields.io/github/v/tag/devopscorner/devopscorner-container?sort=semver)
[![aws-cli pulls](https://img.shields.io/docker/pulls/devopscorner/aws-cli.svg?label=aws-cli%20pulls&logo=docker)](https://hub.docker.com/r/devopscorner/aws-cli/)
![download all](https://img.shields.io/github/downloads/devopscorner/devopscorner-container/total.svg)
![view](https://views.whatilearened.today/views/github/devopscorner/devopscorner-container.svg)
![clone](https://img.shields.io/badge/dynamic/json?color=success&label=clone&query=count&url=https://raw.githubusercontent.com/devopscorner/devopscorner-container/master/clone.json?raw=True&logo=github)
![issues](https://img.shields.io/github/issues/devopscorner/devopscorner-container)
![pull requests](https://img.shields.io/github/issues-pr/devopscorner/devopscorner-container)
![forks](https://img.shields.io/github/forks/devopscorner/devopscorner-container)
![stars](https://img.shields.io/github/stars/devopscorner/devopscorner-container)
[![license](https://img.shields.io/github/license/devopscorner/devopscorner-container)](https://img.shields.io/github/license/devopscorner/devopscorner-container)

---

## Container `devopscorner/aws-cli` Available Tags

### Alpine 3.17

| Image name | Size |
|------------|------|
| `devopscorner/aws-cli:latest` | [![docker image size](https://img.shields.io/docker/image-size/devopscorner/aws-cli/latest.svg?label=Image%20size&logo=docker)](https://hub.docker.com/repository/docker/devopscorner/aws-cli/tags?page=1&ordering=last_updated&name=latest) ![default-aws-cli](https://img.shields.io/static/v1?label=latest&message=default&color=brightgreen) ![latest-aws-cli](https://img.shields.io/static/v1?label=latest&message=alpine&color=orange) |
| `devopscorner/aws-cli:alpine-3.17` | [![docker image size](https://img.shields.io/docker/image-size/devopscorner/aws-cli/alpine-3.17.svg?label=Image%20size&logo=docker)](https://hub.docker.com/repository/docker/devopscorner/aws-cli/tags?page=1&ordering=last_updated&name=alpine-3.17) |
| `devopscorner/aws-cli:alpine3.17-2.10.0` | [![docker image size](https://img.shields.io/docker/image-size/devopscorner/aws-cli/alpine3.17-2.10.0.svg?label=Image%20size&logo=docker)](https://hub.docker.com/repository/docker/devopscorner/aws-cli/tags?page=1&ordering=last_updated&name=alpine3.17-2.10.0) |
| `devopscorner/aws-cli:alpine3.17-python3.10.10-2.10.0` | [![docker image size](https://img.shields.io/docker/image-size/devopscorner/aws-cli/alpine3.17-2.10.0.svg?label=Image%20size&logo=docker)](https://hub.docker.com/repository/docker/devopscorner/aws-cli/tags?page=1&ordering=last_updated&name=alpine3.17-2.10.0) |
| `devopscorner/aws-cli:2.10.0` | [![docker image size](https://img.shields.io/docker/image-size/devopscorner/aws-cli/2.10.0.svg?label=Image%20size&logo=docker)](https://hub.docker.com/repository/docker/devopscorner/aws-cli/tags?page=1&ordering=last_updated&name=2.10.0) |
| `devopscorner/aws-cli:python3.10.10` | [![docker image size](https://img.shields.io/docker/image-size/devopscorner/aws-cli/python3.10.10.svg?label=Image%20size&logo=docker)](https://hub.docker.com/repository/docker/devopscorner/aws-cli/tags?page=1&ordering=last_updated&name=python3.10.10) |
| `devopscorner/aws-cli:python3.10.10-2.10.0` | [![docker image size](https://img.shields.io/docker/image-size/devopscorner/aws-cli/python3.10.10-2.10.0.svg?label=Image%20size&logo=docker)](https://hub.docker.com/repository/docker/devopscorner/aws-cli/tags?page=1&ordering=last_updated&name=python3.10.10-2.10.0) |

### Alpine 3.16

| Image name | Size |
|------------|------|
| `devopscorner/aws-cli:alpine-3.16` | [![docker image size](https://img.shields.io/docker/image-size/devopscorner/aws-cli/alpine-3.16.svg?label=Image%20size&logo=docker)](https://hub.docker.com/repository/docker/devopscorner/aws-cli/tags?page=1&ordering=last_updated&name=alpine-3.16) |
| `devopscorner/aws-cli:alpine3.16-2.10.0` | [![docker image size](https://img.shields.io/docker/image-size/devopscorner/aws-cli/alpine3.16-2.10.0.svg?label=Image%20size&logo=docker)](https://hub.docker.com/repository/docker/devopscorner/aws-cli/tags?page=1&ordering=last_updated&name=alpine3.16-2.10.0) |
| `devopscorner/aws-cli:alpine3.16-python3.10.10-2.10.0` | [![docker image size](https://img.shields.io/docker/image-size/devopscorner/aws-cli/alpine3.16-2.10.0.svg?label=Image%20size&logo=docker)](https://hub.docker.com/repository/docker/devopscorner/aws-cli/tags?page=1&ordering=last_updated&name=alpine3.16-2.10.0) |

### Alpine 3.16 (Depreciated)

| Image name | Size |
|------------|------|
| `devopscorner/aws-cli:2.9.1` | [![docker image size](https://img.shields.io/docker/image-size/devopscorner/aws-cli/2.9.1.svg?label=Image%20size&logo=docker)](https://hub.docker.com/repository/docker/devopscorner/aws-cli/tags?page=1&ordering=last_updated&name=2.9.1) |
| `devopscorner/aws-cli:python3.10.8-2.9.1` | [![docker image size](https://img.shields.io/docker/image-size/devopscorner/aws-cli/python3.10.8-2.9.1.svg?label=Image%20size&logo=docker)](https://hub.docker.com/repository/docker/devopscorner/aws-cli/tags?page=1&ordering=last_updated&name=python3.10.8-2.9.1) |
| `devopscorner/aws-cli:alpine3.16-python3.10.8-2.9.1` | [![docker image size](https://img.shields.io/docker/image-size/devopscorner/aws-cli/alpine3.16-python3.10.8-2.9.1.svg?label=Image%20size&logo=docker)](https://hub.docker.com/repository/docker/devopscorner/aws-cli/tags?page=1&ordering=last_updated&name=alpine3.16-python3.10.8-2.9.1) |

---

## AWS CLI Environment Variables

### References
 - [CLI Configure](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-envvars.html)

### Linux
```
$ export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
$ export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
$ export AWS_DEFAULT_REGION=ap-southeast-1
```

### Windows
```
## To set for all sessions
C:\> setx AWS_ACCESS_KEY_ID AKIAIOSFODNN7EXAMPLE
C:\> setx AWS_SECRET_ACCESS_KEY wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
C:\> setx AWS_DEFAULT_REGION ap-southeast-1

## To set for current session only
C:\> set AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
C:\> set AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
C:\> set AWS_DEFAULT_REGION=ap-southeast-1
```

### PowerShell

```
PS C:\> $Env:AWS_ACCESS_KEY_ID="AKIAIOSFODNN7EXAMPLE"
PS C:\> $Env:AWS_SECRET_ACCESS_KEY="wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"
PS C:\> $Env:AWS_DEFAULT_REGION="ap-southeast-1"
```

## Environment

```docker
ARG ALPINE_VERSION=3.17
ARG AWS_CLI_VERSION=2.10.0
ENV CICD_VERSION="1.23"
```

## Dockerfile

```docker
ARG BUILD_DATE
ARG BUILD_VERSION
ARG GIT_COMMIT
ARG GIT_URL
ARG ALPINE_VERSION=3.17

### Builder ###
FROM python:3.10.10-alpine${ALPINE_VERSION} as builder

ARG AWS_CLI_VERSION=2.10.0
RUN apk add --no-cache git unzip groff build-base libffi-dev cmake
RUN git clone --single-branch --depth 1 -b ${AWS_CLI_VERSION} https://github.com/aws/aws-cli.git

WORKDIR aws-cli
RUN python -m venv venv
RUN . venv/bin/activate
RUN scripts/installers/make-exe
RUN unzip -q dist/awscli-exe.zip
RUN aws/install --bin-dir /aws-cli-bin
RUN /aws-cli-bin/aws --version

# reduce image size: remove autocomplete and examples
RUN rm -rf \
    /usr/local/aws-cli/v2/current/dist/aws_completer \
    /usr/local/aws-cli/v2/current/dist/awscli/data/ac.index \
    /usr/local/aws-cli/v2/current/dist/awscli/examples
RUN find /usr/local/aws-cli/v2/current/dist/awscli/data -name completions-1*.json -delete
RUN find /usr/local/aws-cli/v2/current/dist/awscli/botocore/data -name examples-1.json -delete

### Binary ###
FROM alpine:${ALPINE_VERSION}

ENV VENDOR="DevOpsCornerId"
ENV AUTHOR="DevOpsCorner.id <support@devopscorner.id>"
ENV IMG_NAME="awscli-alpine"
ENV IMG_VERSION="3.17"
ENV IMG_DESC="Docker Image AWS CLI Alpine"
ENV IMG_ARCH="amd64/x86_64"

ENV CICD_VERSION="1.23"

LABEL maintainer="$AUTHOR" \
      architecture="$IMG_ARCH" \
      alpine-version="$ALPINE_VERSION" \
      cicd-version="$CICD_VERSION" \
      org.label-schema.build-date="$BUILD_DATE" \
      org.label-schema.name="$IMG_NAME" \
      org.label-schema.description="$IMG_DESC" \
      org.label-schema.vcs-ref="$GIT_COMMIT" \
      org.label-schema.vcs-url="$GIT_URL" \
      org.label-schema.vendor="$VENDOR" \
      org.label-schema.version="$BUILD_VERSION" \
      org.label-schema.schema-version="$IMG_VERSION" \
      org.opencontainers.image.authors="$AUTHOR" \
      org.opencontainers.image.description="$IMG_DESC" \
      org.opencontainers.image.vendor="$VENDOR" \
      org.opencontainers.image.version="$IMG_VERSION" \
      org.opencontainers.image.revision="$GIT_COMMIT" \
      org.opencontainers.image.created="$BUILD_DATE" \
      fr.hbis.docker.base.build-date="$BUILD_DATE" \
      fr.hbis.docker.base.name="$IMG_NAME" \
      fr.hbis.docker.base.vendor="$VENDOR" \
      fr.hbis.docker.base.version="$BUILD_VERSION"

COPY --from=builder /usr/local/aws-cli/ /usr/local/aws-cli/
COPY --from=builder /aws-cli-bin/ /usr/local/bin/
```
